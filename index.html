<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Faces from Places</title>
    <link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
</head>
<body>
    <section class="body-font">
        <div class="container mx-auto flex px-5 py-24 items-center justify-center flex-col">
            <img class="lg:w-2/6 md:w-3/6 w-5/6 mb-10 object-cover object-center rounded" alt="rainbow paint on canvas" src="./Faces from Places.png">
            <div class="text-center lg:w-2/3 w-full">
                <h1 class="title-font sm:text-4xl text-3xl mb-4 font-bold">Faces From Places</h1>
                <h2 class="text-xl my-4 font-bold">We abide by <a href="https://en.wikipedia.org/wiki/The_Four_Agreements">The Four Agreements</a></h2>
                <ol>
                    <li>Be Impeccable With Your Word</li>
                    <li>Don't Take Anything Personally</li>
                    <li>Don't Make Assumptions</li>
                    <li>Always Do Your Best</li>
                </ol>

                <h2 class="text-xl my-4 font-bold">Tools</h2>

                <h3>Icebreaker generator</h3>
                <div class="flex justify-center mt-4">
                    <button class="inline-flex text-white bg-green-500 border-0 py-2 px-6 focus:outline-none hover:bg-red-600 rounded text-lg" id="icebreaker-button">Generate</button>
                </div>
                <textarea id="icebreaker-result" class="mt-4 w-1/2 bg-white rounded border border-gray-300 focus:border-green-500 focus:ring-2 focus:ring-green-200 h-32 text-base outline-none text-gray-700 py-1 px-3 resize-none leading-6 transition-colors duration-200 ease-in-out"></textarea>
                <div class="flex justify-center mt-4">
                    <button class="inline-flex text-white bg-green-500 border-0 py-2 px-6 focus:outline-none hover:bg-red-600 rounded text-lg hidden" id="icebreaker-copy">Copy to clipboard</button>
                </div>
            </div>
        </div>
    </section>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://unpkg.com/jquery-csv@1.0.21/src/jquery.csv.js"></script>
    <script type="text/javascript">
        function getRandomInt(max) {
            return Math.floor(Math.random() * max);
        }

        function copyToClipboard(value) {
          navigator.clipboard.writeText(value);
          alert("Copied to clipboard!");
        }

        $(function() {
            $.get('data.csv', function(data) {
                const entries = $.csv.toObjects(data);

                const questionKey = "Question";
                const categoryKey = "Categories (yes/no, casual, deep)";

                const questions = [];
                const categories = ["all"];
                for (let entry of entries) {
                    questions.push(entry[questionKey]);


                    const category = entry[categoryKey];
                    if (category.trim().length > 0 && !categories.includes(category)) {
                        categories.push(category);
                    }
                    // TODO:
                    // - if categories.length > 1, then show a dropdown for categories
                }

                $("#icebreaker-button").click(function() {
                    // TODO: check the value of the currently selected dropdown option,
                    // - if itâ€™s anything other than "all", use it to filter the possible questions

                    var question = questions[getRandomInt(questions.length)];
                    $("#icebreaker-result").text(question);
                    $("#icebreaker-copy").show();
                });

                $("#icebreaker-copy").click(function() {
                    copyToClipboard($("#icebreaker-result").text());
                })
            }, 'text');
        });
    </script>
</body>
</html>
